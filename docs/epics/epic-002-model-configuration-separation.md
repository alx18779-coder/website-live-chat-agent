# Epic 002: 模型配置分离与平台扩展

**创建时间**: 2025-10-15  
**负责角色**: PM (Product Manager AI)  
**状态**: 规划中  
**优先级**: P1 (高)

---

## 业务背景

### 问题陈述

当前系统的LLM模型和embedding模型使用相同的API配置，存在以下限制：

1. **配置僵化**：用户无法根据具体需求选择不同的模型组合
2. **成本控制困难**：无法灵活选择不同价位的模型组合来优化成本
3. **性能优化受限**：无法为不同场景选择最适合的模型组合
4. **平台选择有限**：缺乏对新兴AI平台的支持

### 解决方案

实现模型配置分离，支持混合模型组合使用，并扩展平台支持：

- 支持LLM和embedding模型的独立配置
- 支持不同提供商的模型组合使用
- 增加对硅基流动平台等新兴平台的支持
- 保持现有配置的向后兼容性

### 目标用户

1. **系统管理员**：需要灵活配置模型组合，优化成本和性能
2. **开发者**：需要根据业务需求选择最适合的模型组合
3. **运维人员**：需要支持更多部署平台，提升系统性能

---

## 业务价值

- **配置灵活性**：用户可以根据需求独立选择LLM和embedding模型
- **成本优化**：支持使用不同价位的模型组合，实现成本效益最大化
- **性能优化**：支持选择最适合特定场景的模型组合
- **平台扩展**：支持更多部署平台，提升系统性能和稳定性

## 核心功能需求

### 用户故事 1: 灵活模型组合配置

**作为** 系统管理员  
**我希望** 能够灵活选择不同提供商的LLM和embedding模型组合  
**以便于** 根据业务需求优化成本和性能，实现最佳的业务价值

**验收标准**:

1. **配置灵活性**：
   - 能够为LLM和embedding模型分别设置不同提供商的API
   - 支持DeepSeek LLM + OpenAI Embedding等混合组合
   - 支持OpenAI LLM + DeepSeek Embedding等混合组合
   - 配置验证能够检查各API的有效性

2. **用户体验**：
   - 配置过程简单直观，无需技术背景
   - 提供清晰的配置文档和示例
   - 配置错误时提供友好的错误信息和解决建议

3. **功能完整性**：
   - RAG功能在混合模型下正常工作
   - 对话功能在混合模型下正常工作
   - 向量检索功能在混合模型下正常工作
   - 系统性能稳定，响应时间在可接受范围内

4. **向后兼容性**：
   - 现有配置继续正常工作
   - 现有部署无需修改配置
   - 提供配置迁移指南

**场景示例**:

```
业务场景：成本优化配置
前提条件：
- 系统已部署并运行
- 管理员有DeepSeek和OpenAI的API Key

操作步骤：
1. 进入系统配置页面
2. 在LLM配置部分设置DeepSeek API（成本较低）
3. 在Embedding配置部分设置OpenAI API（质量较高）
4. 点击"测试配置"按钮
5. 系统显示"配置验证成功"
6. 保存配置并重启服务

预期结果：
- 系统使用DeepSeek进行对话生成（节省成本）
- 系统使用OpenAI进行向量嵌入（保证质量）
- 相比全OpenAI配置节省约30%成本
- 所有功能正常工作，性能稳定
```

---

### 用户故事 2: 硅基流动平台支持

**作为** 运维人员  
**我希望** 系统支持硅基流动平台部署  
**以便于** 利用其硬件优势提升系统性能，降低延迟

**验收标准**:

1. **平台集成**：
   - 系统能够识别和配置硅基流动平台
   - 支持硅基流动平台的LLM和embedding模型
   - 提供硅基流动平台的配置文档

2. **性能优势**：
   - 在硅基流动平台上的性能优于其他平台
   - 响应时间显著降低
   - 并发处理能力提升

3. **稳定性保证**：
   - 长期运行稳定
   - 错误恢复能力强
   - 资源使用合理

**场景示例**:

```
部署场景：高性能生产环境
- 选择硅基流动平台部署
- 利用其GPU加速能力
- 预期性能提升：响应时间减少50%，并发能力提升3倍

性能对比：
传统云平台：平均响应时间 2.5s，并发 100 QPS
硅基流动平台：平均响应时间 1.2s，并发 300 QPS
```

## Epic级别验收标准

### 功能验收
- [ ] 系统支持灵活的模型组合配置（LLM和embedding可独立选择不同提供商）
- [ ] 系统支持硅基流动平台部署
- [ ] 保持向后兼容性

### 质量验收
- [ ] 所有现有功能正常工作
- [ ] 新功能性能满足要求
- [ ] 配置文档完整清晰

### 业务价值验收
- [ ] 用户能够实现成本优化目标
- [ ] 用户能够提升系统性能
- [ ] 用户能够灵活选择部署平台

## 时间规划

- **需求分析**: 1天
- **设计阶段**: 2天  
- **开发阶段**: 5天
- **测试阶段**: 2天
- **文档阶段**: 1天
- **总计**: 11天

## 成功指标

### 功能指标
- 配置分离功能正常工作
- 混合模型组合功能正常
- 硅基流动平台集成成功

### 质量指标
- 测试覆盖率 ≥ 90%
- 性能回归 ≤ 5%
- 用户满意度 ≥ 4.5/5

### 业务指标
- 用户配置灵活性提升
- 系统成本优化效果明显
- 平台选择范围扩大
