# FAQ 前端管理界面使用指南

## 功能概述

FAQ 管理界面提供了完整的 FAQ 导入和管理功能，包括：

- ✅ CSV 文件上传和预览
- ✅ 灵活的列配置（选择哪些列用于文本和向量）
- ✅ 自定义文本模板
- ✅ FAQ 列表查看
- ✅ 按语言过滤
- ✅ FAQ 详情查看
- ✅ FAQ 删除

## 访问路径

登录管理后台后，点击左侧菜单的 **"FAQ 管理"** 进入。

## 使用流程

### 1. 上传 CSV 文件

**步骤 1：选择文件**

1. 点击 **"CSV 上传"** 标签页
2. 点击上传区域或拖拽 CSV 文件到上传区
3. 系统会自动解析 CSV 并显示预览

**CSV 文件要求：**
- 必须是 UTF-8 编码的 CSV 文件
- 第一行应该是列名（header）
- 支持中英文内容

**示例 CSV：**
```csv
question,answer
你们的泵可以处理高粘度油品吗？,是的，我们有专为高粘度介质设计的型号。
泵体的主要材质是什么？,泵体通常采用高强度铸铁或铝合金。
```

### 2. 配置列映射

**步骤 2：选择列**

预览成功后，点击 **"下一步"** 进入配置页面：

1. **文本列 (text)**
   - 选择用于生成展示文本的列
   - 可以选择多列（如 `question` + `answer`）
   - 这些列将按模板拼接成文本

2. **向量列 (embedding)**
   - 选择用于生成检索向量的列
   - **建议只选择问题列**（如 `question`）
   - 用户的查询将与这些列的向量进行匹配

3. **文本模板**
   - 定义如何拼接文本
   - 使用 `{column_name}` 作为占位符
   - 默认模板：`{question}\n答：{answer}`
   - 自定义示例：
     ```
     Q: {question}
     A: {answer}
     ```

4. **语言**
   - 选择 FAQ 的语言（中文/英文）
   - 系统会自动检测并预选

### 3. 确认导入

**步骤 3：开始导入**

1. 检查配置摘要
2. 点击 **"开始导入"** 按钮
3. 等待进度条完成
4. 导入成功后自动跳转到 FAQ 列表

**注意事项：**
- 导入过程中会生成向量，可能需要一些时间
- 不要关闭页面或刷新浏览器

### 4. 管理 FAQ

**查看列表**

1. 点击 **"FAQ列表"** 标签页
2. 可以按语言过滤（中文/英文/全部）
3. 支持分页浏览

**查看详情**

- 点击任意 FAQ 的 **"查看"** 按钮
- 显示完整的问题、答案、语言、创建时间

**删除 FAQ**

- 点击任意 FAQ 的 **"删除"** 按钮
- 确认后删除（不可恢复）

## 配置示例

### 示例 1：标准 FAQ（只用问题检索）

**CSV 格式：**
```csv
question,answer
你们的泵可以处理高粘度油品吗？,是的，我们有专为高粘度介质设计的型号。
```

**配置：**
- 文本列：`question`, `answer`
- 向量列：`question`
- 文本模板：`{question}\n答：{answer}`
- 语言：中文

**结果：**
- 用户搜索"高粘度油"时，会匹配到这条FAQ
- 返回完整的问题和答案

### 示例 2：带分类的 FAQ

**CSV 格式：**
```csv
question,answer,category
你们的泵可以处理高粘度油品吗？,是的...,技术问题
你们提供OEM服务吗？,是的...,商务咨询
```

**配置：**
- 文本列：`question`, `answer`, `category`
- 向量列：`question`
- 文本模板：`[{category}] {question}\n答：{answer}`
- 语言：中文

**结果：**
- 展示文本会包含分类标签
- 向量检索仍然基于问题

### 示例 3：问题+答案一起检索

**CSV 格式：**
```csv
question,answer
你们有ISO 9001认证吗？,是的，我们严格执行 ISO 9001:2015 质量管理体系。
```

**配置：**
- 文本列：`question`, `answer`
- 向量列：`question`, `answer`
- 文本模板：`{question}\n答：{answer}`
- 语言：中文

**结果：**
- 用户搜索"ISO 9001"时也能匹配（因为答案中包含）
- 适合答案中包含关键专业术语的场景

## 最佳实践

### 1. 问题规范化

- ✅ 清晰、简洁的问题
- ✅ 覆盖常见的表述方式
- ❌ 避免过于简短或模糊

**推荐：**
```
你们的泵可以处理高粘度油品吗？
```

**不推荐：**
```
高粘度？
```

### 2. 答案完整性

- ✅ 答案应该自包含，无需额外上下文
- ✅ 提供具体信息
- ❌ 避免"请联系我们"这类无信息答案

### 3. 向量列选择

**推荐：只选择问题列**
- 用户的查询通常是问题形式
- 问题-问题匹配效果最好

**可选：问题+答案**
- 适合答案中包含关键专业术语
- 可能会降低匹配精准度

### 4. 语言管理

- 中文和英文 FAQ 分别标记
- 可以通过语言过滤查看
- 在召回时可以只搜索特定语言

### 5. 定期维护

- 及时添加新的常见问题
- 删除过时的 FAQ
- 根据用户反馈优化问题表述

## 故障排查

### 问题 1：CSV 上传失败

**错误：** "仅支持CSV格式文件"

**解决：**
- 确保文件扩展名是 `.csv`
- 确保文件编码是 UTF-8
- 使用 Excel 时，选择 "CSV UTF-8" 格式导出

### 问题 2：预览显示乱码

**原因：** 编码问题

**解决：**
1. 在 Excel 中：
   - 另存为 → CSV UTF-8 (逗号分隔)
2. 使用文本编辑器：
   - 打开 CSV
   - 选择 "另存为"
   - 编码选择 UTF-8

### 问题 3：导入卡住不动

**可能原因：**
- 文件太大（>1000行）
- 网络问题
- 后端 Embedding 服务未响应

**解决：**
- 将大文件拆分成小批次
- 检查网络连接
- 查看后端日志

### 问题 4：配置后无法点击"下一步"

**原因：** 配置不完整

**解决：**
- 确保选择了至少一个文本列
- 确保选择了至少一个向量列
- 两个配置都是必填项

## 技术说明

### 前端文件

- `src/api/faq.ts` - FAQ API 客户端
- `src/pages/FAQ.vue` - FAQ 管理页面
- `src/router/index.ts` - 路由配置（新增 FAQ 路由）
- `src/layouts/MainLayout.vue` - 主布局（新增 FAQ 菜单）

### API 端点

- `POST /api/admin/faq/upload/preview` - 预览 CSV
- `POST /api/admin/faq/upload/import` - 导入 FAQ
- `GET /api/admin/faq/list` - 查询列表
- `GET /api/admin/faq/{id}` - 获取详情
- `DELETE /api/admin/faq/{id}` - 删除 FAQ

### 数据流

```
用户上传CSV
    ↓
前端调用 preview API
    ↓
后端解析CSV并返回列信息
    ↓
用户配置列映射
    ↓
前端调用 import API
    ↓
后端生成 embedding 并存入 Milvus
    ↓
导入完成，跳转到列表
```

## 开发和部署

### 本地开发

```bash
cd admin-frontend

# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build
```

### 环境变量

前端通过 `src/api/client.ts` 中的 baseURL 连接后端。

确保后端服务已启动：
```bash
python src/main.py
```

## 后续优化建议

1. **批量操作**
   - 批量删除
   - 批量导出

2. **搜索功能**
   - 在列表中搜索 FAQ
   - 按关键词过滤

3. **编辑功能**
   - 在线编辑 FAQ 内容
   - 无需重新上传 CSV

4. **预览优化**
   - 显示更多预览行
   - 支持大文件分页预览

5. **统计分析**
   - FAQ 使用频率统计
   - 最受欢迎的 FAQ

6. **批量更新**
   - 支持更新现有 FAQ
   - 智能去重

